import { DocumentEditor } from '../../src/document-editor/document-editor';
import { DocumentHelper } from '../../src/document-editor/implementation/viewer/viewer';
import { createElement } from '@syncfusion/ej2-base';
import { TestHelper } from '../test-helper.spec';
import { Editor } from '../../src/document-editor/implementation/editor/editor';
import { EditorHistory } from '../../src/document-editor/implementation/editor-history/editor-history';
import { Selection } from '../../src/document-editor/implementation/selection/selection';
import { WordExport } from '../../src/document-editor/implementation/writer/word-export';
import { SfdtExport } from '../../src/document-editor/implementation/writer/sfdt-export';
let docEditorJsonString: any = {
    "sections": [{ "sectionFormat": { "pageWidth": 612, "pageHeight": 792, "leftMargin": 72, "rightMargin": 72, "topMargin": 72, "bottomMargin": 72, "differentFirstPage": false, "differentOddAndEvenPages": false, "headerDistance": 36, "footerDistance": 36, "bidi": false }, "blocks": [{ "paragraphFormat": { "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "Line1 Line1.1" }] }, { "paragraphFormat": { "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "Line2 Line2.1" }] }, { "paragraphFormat": { "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }, { "rows": [{ "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td 1.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td 1.2" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }, { "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td 2.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td 2.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }, { "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td 3.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "preferredWidthType": "Point", "cellWidth": 234, "columnSpan": 1, "rowSpan": 1, "verticalAlignment": "Top" }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td3.2" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "preferredWidthType": "Point", "cellWidth": 234, "columnSpan": 1, "rowSpan": 1, "verticalAlignment": "Top" }, "columnIndex": 1 }], "rowFormat": { "height": 0, "allowBreakAcrossPages": true, "heightType": "Auto", "isHeader": false, "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridBeforeWidth": 0, "gridBeforeWidthType": "Point", "gridAfter": 0, "gridAfterWidth": 0, "gridAfterWidthType": "Point", "leftIndent": 0 } }], "grid": [234, 234], "tableFormat": { "borders": { "top": { "lineStyle": "Single", "lineWidth": 0.5 }, "left": { "lineStyle": "Single", "lineWidth": 0.5 }, "right": { "lineStyle": "Single", "lineWidth": 0.5 }, "bottom": { "lineStyle": "Single", "lineWidth": 0.5 }, "diagonalDown": {}, "diagonalUp": {}, "horizontal": { "lineStyle": "Single", "lineWidth": 0.5 }, "vertical": { "lineStyle": "Single", "lineWidth": 0.5 } }, "shading": {}, "leftIndent": 0, "topMargin": 0, "rightMargin": 5.4, "leftMargin": 5.4, "bottomMargin": 0, "preferredWidthType": "Auto" }, "columnCount": 2 }, { "paragraphFormat": { "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }, { "rows": [{ "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.1" }] }, { "rows": [{ "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.1.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 111.6, "cellWidth": 111.6, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.1.2" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 111.6, "cellWidth": 111.6, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }, { "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.2.1" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 111.6, "cellWidth": 111.6, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.2.2" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 111.6, "cellWidth": 111.6, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }], "grid": [111.6, 111.6], "tableFormat": { "borders": { "top": { "lineStyle": "Single", "lineWidth": 0.5 }, "left": { "lineStyle": "Single", "lineWidth": 0.5 }, "right": { "lineStyle": "Single", "lineWidth": 0.5 }, "bottom": { "lineStyle": "Single", "lineWidth": 0.5 }, "diagonalDown": {}, "diagonalUp": {}, "horizontal": { "lineStyle": "Single", "lineWidth": 0.5 }, "vertical": { "lineStyle": "Single", "lineWidth": 0.5 } }, "shading": {}, "leftIndent": 0, "topMargin": 0, "rightMargin": 5.4, "leftMargin": 5.4, "bottomMargin": 0, "preferredWidthType": "Auto" }, "columnCount": 2 }, { "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }, { "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": { "bidi": false }, "text": "td2 1.2" }] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }, { "cells": [{ "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 0 }, { "blocks": [{ "paragraphFormat": { "leftIndent": 0, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }], "cellFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "shading": {}, "preferredWidth": 234, "cellWidth": 234, "columnSpan": 1, "rowSpan": 1 }, "columnIndex": 1 }], "rowFormat": { "height": 0, "heightType": "Auto", "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "diagonalDown": {}, "diagonalUp": {}, "horizontal": {}, "vertical": {} }, "gridBefore": 0, "gridAfter": 0 } }], "grid": [234, 234], "tableFormat": { "borders": { "top": { "lineStyle": "Single", "lineWidth": 0.5 }, "left": { "lineStyle": "Single", "lineWidth": 0.5 }, "right": { "lineStyle": "Single", "lineWidth": 0.5 }, "bottom": { "lineStyle": "Single", "lineWidth": 0.5 }, "diagonalDown": {}, "diagonalUp": {}, "horizontal": { "lineStyle": "Single", "lineWidth": 0.5 }, "vertical": { "lineStyle": "Single", "lineWidth": 0.5 } }, "shading": {}, "leftIndent": 0, "topMargin": 0, "rightMargin": 5.4, "leftMargin": 5.4, "bottomMargin": 0, "preferredWidthType": "Auto" }, "columnCount": 2 }, { "paragraphFormat": { "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }], "headersFooters": { "header": { "blocks": [{ "paragraphFormat": { "listFormat": {} }, "characterFormat": {}, "inlines": [] }] }, "footer": { "blocks": [{ "paragraphFormat": { "listFormat": {} }, "characterFormat": {}, "inlines": [] }] }, "evenHeader": {}, "evenFooter": {}, "firstPageHeader": {}, "firstPageFooter": {} } }], "characterFormat": { "bold": false, "italic": false, "fontSize": 11, "fontFamily": "Calibri", "underline": "None", "strikethrough": "None", "baselineAlignment": "Normal", "highlightColor": "NoColor", "fontColor": "empty", "boldBidi": false, "italicBidi": false, "fontSizeBidi": 11, "fontFamilyBidi": "Calibri", "allCaps": false }, "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 0, "afterSpacing": 0, "lineSpacing": 1, "lineSpacingType": "Multiple", "listFormat": {}, "bidi": false }, "defaultTabWidth": 36, "trackChanges": false, "enforcement": false, "hashValue": "", "saltValue": "", "formatting": false, "protectionType": "NoProtection", "dontUseHTMLParagraphAutoSpacing": false, "formFieldShading": true, "styles": [{ "name": "Normal", "type": "Paragraph", "paragraphFormat": { "listFormat": {} }, "characterFormat": {}, "next": "Normal" }, { "name": "Heading 1", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 12, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level1", "listFormat": {} }, "characterFormat": { "fontSize": 16, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontSizeBidi": 16, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 1 Char", "next": "Normal" }, { "name": "Heading 1 Char", "type": "Character", "characterFormat": { "fontSize": 16, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontSizeBidi": 16, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }, { "name": "Default Paragraph Font", "type": "Character", "characterFormat": {} }, { "name": "Heading 2", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 2, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level2", "listFormat": {} }, "characterFormat": { "fontSize": 13, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontSizeBidi": 13, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 2 Char", "next": "Normal" }, { "name": "Heading 2 Char", "type": "Character", "characterFormat": { "fontSize": 13, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontSizeBidi": 13, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 3", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 2, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level3", "listFormat": {} }, "characterFormat": { "fontSize": 12, "fontFamily": "Calibri Light", "fontColor": "#1F3763", "fontSizeBidi": 12, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 3 Char", "next": "Normal" }, { "name": "Heading 3 Char", "type": "Character", "characterFormat": { "fontSize": 12, "fontFamily": "Calibri Light", "fontColor": "#1F3763", "fontSizeBidi": 12, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 4", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 2, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level4", "listFormat": {} }, "characterFormat": { "italic": true, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "italicBidi": true, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 4 Char", "next": "Normal" }, { "name": "Heading 4 Char", "type": "Character", "characterFormat": { "italic": true, "fontFamily": "Calibri Light", "fontColor": "#2F5496", "italicBidi": true, "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 5", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 2, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level5", "listFormat": {} }, "characterFormat": { "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 5 Char", "next": "Normal" }, { "name": "Heading 5 Char", "type": "Character", "characterFormat": { "fontFamily": "Calibri Light", "fontColor": "#2F5496", "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 6", "type": "Paragraph", "paragraphFormat": { "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 2, "afterSpacing": 0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple", "outlineLevel": "Level6", "listFormat": {} }, "characterFormat": { "fontFamily": "Calibri Light", "fontColor": "#1F3763", "fontFamilyBidi": "Calibri Light" }, "basedOn": "Normal", "link": "Heading 6 Char", "next": "Normal" }, { "name": "Heading 6 Char", "type": "Character", "characterFormat": { "fontFamily": "Calibri Light", "fontColor": "#1F3763", "fontFamilyBidi": "Calibri Light" }, "basedOn": "Default Paragraph Font" }], "lists": [], "abstractLists": [], "comments": [], "revisions": [], "customXml": []
}
describe('Change text case Module', () => {
    let editor: DocumentEditor;
    let documentHelper: DocumentHelper;
    beforeAll((): void => {
        document.body.appendChild(createElement('div', { id: 'container' }));
        DocumentEditor.Inject(Editor, Selection, WordExport, SfdtExport, EditorHistory);
        editor = new DocumentEditor({ enableEditorHistory: true, enableWordExport: true, enableEditor: true, isReadOnly: false, enableSelection: true, enableSfdtExport: true });
        editor.acceptTab = true;
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
        documentHelper = editor.documentHelper;
        editor.open(JSON.stringify(docEditorJsonString));
    });
    afterAll((done): void => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        setTimeout(function () {
            document.body.innerHTML = '';
            done();
        }, 1000);
    });

    it('Change text case into UPPERCASE', () => {
        console.log('Changing text case into UPPERCASE');
        editor.selection.selectAll();
        expect(() => {
            editor.editorModule.changeCase('Uppercase');
        }).not.toThrowError();
    });
});