import { DocumentEditor } from '../../../src/document-editor/document-editor';
import { createElement } from '@syncfusion/ej2-base';
import { Editor, Page, HelperMethods, ParagraphWidget } from '../../../src/index';
import { TestHelper } from '../../test-helper.spec';
import { Selection } from '../../../src/index';
import { EditorHistory } from '../../../src/document-editor/implementation/editor-history/editor-history';

/**
 * Widow/Orphan control spec.
 */
describe('Widow/Orphan control', () => {
    let editor: DocumentEditor;
    beforeAll((): void => {
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        editor = new DocumentEditor({ enableEditor: true, isReadOnly: false });
        DocumentEditor.Inject(Editor, Selection, EditorHistory);
        editor.enableEditorHistory = true;
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
    });
    afterAll((done): void => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        document.body.innerHTML = '';
        setTimeout(() => {
            document.body.innerHTML = '';
            done();
        }, 750);
    });
    it('Move two lines to next page', () => {
        let sfdt: any = '{"sections":[{"blocks":[{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0},"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"AdventureWorks","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets.","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"styleName":"Normal"},"inlines":[]}],"headersFooters":{"header":{"blocks":[{"inlines":[]}]},"footer":{"blocks":[{"inlines":[]}]},"evenHeader":{"blocks":[{"inlines":[]}]},"evenFooter":{"blocks":[{"inlines":[]}]},"firstPageHeader":{"blocks":[{"inlines":[]}]},"firstPageFooter":{"blocks":[{"inlines":[]}]}},"sectionFormat":{"headerDistance":36.0,"footerDistance":36.0,"pageWidth":612.0,"pageHeight":792.0,"leftMargin":72.0,"rightMargin":72.0,"topMargin":72.0,"bottomMargin":72.0,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"restartPageNumbering":false,"pageStartingNumber":0,"endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart"}}],"characterFormat":{"fontSize":11.0,"fontFamily":"Calibri","fontSizeBidi":11.0,"fontFamilyBidi":"Arial"},"paragraphFormat":{"afterSpacing":8.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple"},"background":{"color":"#FFFFFFFF"},"styles":[{"type":"Paragraph","name":"Normal","next":"Normal"},{"type":"Character","name":"Default Paragraph Font"}],"defaultTabWidth":36.0,"formatting":false,"trackChanges":false,"protectionType":"NoProtection","enforcement":false,"dontUseHTMLParagraphAutoSpacing":false,"alignTablesRowByRow":false,"formFieldShading":true,"footnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"endnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"compatibilityMode":"Word2013"}';
        editor.open(sfdt);
        expect(editor.documentHelper.pages.length).toBe(2);
        expect((editor.documentHelper.pages[0].bodyWidgets[0].lastChild as ParagraphWidget).childWidgets.length).toBe(2);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(2);
    });
    it('Move entire paragraph to next page case 1', () => {
       let sfdt: any = '{"sections":[{"blocks":[{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation is located in Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0},"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"AdventureWorks","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"European","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":" and Asian commercial markets.","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"styleName":"Normal"},"inlines":[]}],"headersFooters":{"header":{"blocks":[{"inlines":[]}]},"footer":{"blocks":[{"inlines":[]}]},"evenHeader":{"blocks":[{"inlines":[]}]},"evenFooter":{"blocks":[{"inlines":[]}]},"firstPageHeader":{"blocks":[{"inlines":[]}]},"firstPageFooter":{"blocks":[{"inlines":[]}]}},"sectionFormat":{"headerDistance":36.0,"footerDistance":36.0,"pageWidth":612.0,"pageHeight":792.0,"leftMargin":72.0,"rightMargin":72.0,"topMargin":72.0,"bottomMargin":72.0,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"restartPageNumbering":false,"pageStartingNumber":0,"endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart"}}],"characterFormat":{"fontSize":11.0,"fontFamily":"Calibri","fontSizeBidi":11.0,"fontFamilyBidi":"Arial"},"paragraphFormat":{"afterSpacing":8.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple"},"background":{"color":"#FFFFFFFF"},"styles":[{"type":"Paragraph","name":"Normal","next":"Normal"},{"type":"Character","name":"Default Paragraph Font"}],"defaultTabWidth":36.0,"formatting":false,"trackChanges":false,"protectionType":"NoProtection","enforcement":false,"dontUseHTMLParagraphAutoSpacing":false,"alignTablesRowByRow":false,"formFieldShading":true,"footnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"endnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"compatibilityMode":"Word2013"}';
        
        editor.open(sfdt);
        expect(editor.documentHelper.pages.length).toBe(2);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(4);
    });
    it('Move entire paragraph to next page case 2', () => {
        let sfdt: any = '{"sections":[{"blocks":[{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"afterSpacing":0.0,"styleName":"Normal"},"inlines":[]},{"characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0},"paragraphFormat":{"firstLineIndent":36.0,"afterSpacing":0.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"AdventureWorks","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":" sample manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":"European","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}},{"text":" and Asian commercial markets.","characterFormat":{"fontSize":12.0,"fontSizeBidi":12.0}}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the "},{"text":"AdventureWorks"},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, "},{"text":"European"},{"text":" and Asian commercial markets. While its base operation "},{"text":"is located in"},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base."}]},{"paragraphFormat":{"firstLineIndent":36.0,"styleName":"Normal"},"inlines":[]},{"paragraphFormat":{"styleName":"Normal"},"inlines":[]}],"headersFooters":{"header":{"blocks":[{"inlines":[]}]},"footer":{"blocks":[{"inlines":[]}]},"evenHeader":{"blocks":[{"inlines":[]}]},"evenFooter":{"blocks":[{"inlines":[]}]},"firstPageHeader":{"blocks":[{"inlines":[]}]},"firstPageFooter":{"blocks":[{"inlines":[]}]}},"sectionFormat":{"headerDistance":36.0,"footerDistance":36.0,"pageWidth":612.0,"pageHeight":792.0,"leftMargin":72.0,"rightMargin":72.0,"topMargin":72.0,"bottomMargin":72.0,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"restartPageNumbering":false,"pageStartingNumber":0,"endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart"}}],"characterFormat":{"fontSize":11.0,"fontFamily":"Calibri","fontSizeBidi":11.0,"fontFamilyBidi":"Arial"},"paragraphFormat":{"afterSpacing":8.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple"},"background":{"color":"#FFFFFFFF"},"styles":[{"type":"Paragraph","name":"Normal","next":"Normal"},{"type":"Character","name":"Default Paragraph Font"}],"defaultTabWidth":36.0,"formatting":false,"trackChanges":false,"protectionType":"NoProtection","enforcement":false,"dontUseHTMLParagraphAutoSpacing":false,"alignTablesRowByRow":false,"formFieldShading":true,"footnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"endnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal"},"inlines":[{"text":"\\u0004"}]}],"continuationNotice":[{"inlines":[]}]},"compatibilityMode":"Word2013"}'
        editor.open(sfdt);
        expect(editor.documentHelper.pages.length).toBe(2);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(3);
    });
});


describe('Widow/Orphan control with keep with next combination', () => {
    let editor: DocumentEditor;
    beforeAll((): void => {
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        editor = new DocumentEditor({ enableEditor: true, isReadOnly: false });
        DocumentEditor.Inject(Editor, Selection, EditorHistory);
        editor.enableEditorHistory = true;
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
    });
    afterAll((done): void => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        document.body.innerHTML = '';
        setTimeout(() => {
            document.body.innerHTML = '';
            done();
        }, 750);
    });
    it('Move two lines to next page with keep with next', () => {
       let sfdt: any ='{"sections":[{"blocks":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"styleName":"Normal"},"inlines":[]},{"characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"AdventureWorks","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"European","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"is located in","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" Bothell, Washington with 290 ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"employees, several regional sales teams are located throughout their ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"marke","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"sdweggqegqe","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"t","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" base","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"the fictitious ","characterFormat":{"fontColor":"empty"}},{"text":"company on which","characterFormat":{"bold":true,"fontColor":"empty","boldBidi":true}},{"text":" the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"bold":true,"fontColor":"empty","boldBidi":true}},{"text":" sample","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"styleName":"Normal"},"inlines":[]}],"headersFooters":{"header":{"blocks":[{"inlines":[]}]},"footer":{"blocks":[{"inlines":[]}]},"evenHeader":{"blocks":[{"inlines":[]}]},"evenFooter":{"blocks":[{"inlines":[]}]},"firstPageHeader":{"blocks":[{"inlines":[]}]},"firstPageFooter":{"blocks":[{"inlines":[]}]}},"sectionFormat":{"headerDistance":36,"footerDistance":36,"pageWidth":612,"pageHeight":792,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"restartPageNumbering":false,"pageStartingNumber":0,"endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart"}}],"characterFormat":{"fontSize":11,"fontFamily":"Calibri","fontColor":"empty","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"paragraphFormat":{"afterSpacing":8,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple"},"background":{"color":"#FFFFFFFF"},"styles":[{"type":"Paragraph","name":"Normal","next":"Normal","characterFormat":{"fontColor":"empty"}},{"type":"Character","name":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}},{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","link":"Header Char","characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","tabs":[{"tabJustification":"Center","position":234,"tabLeader":"None","deletePosition":0},{"tabJustification":"Right","position":468,"tabLeader":"None","deletePosition":0}]}},{"type":"Character","name":"Header Char","basedOn":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}},{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","link":"Footer Char","characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","tabs":[{"tabJustification":"Center","position":234,"tabLeader":"None","deletePosition":0},{"tabJustification":"Right","position":468,"tabLeader":"None","deletePosition":0}]}},{"type":"Character","name":"Footer Char","basedOn":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}}],"defaultTabWidth":36,"formatting":false,"trackChanges":false,"protectionType":"NoProtection","enforcement":false,"dontUseHTMLParagraphAutoSpacing":false,"alignTablesRowByRow":false,"formFieldShading":true,"footnotes":{"separator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0003","characterFormat":{"fontColor":"empty"}}]}],"continuationSeparator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0004","characterFormat":{"fontColor":"empty"}}]}],"continuationNotice":[{"inlines":[]}]},"endnotes":{"separator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0003","characterFormat":{"fontColor":"empty"}}]}],"continuationSeparator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0004","characterFormat":{"fontColor":"empty"}}]}],"continuationNotice":[{"inlines":[]}]},"compatibilityMode":3}';
       editor.open(sfdt);
        expect(editor.documentHelper.pages.length).toBe(2);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(2);
        editor.selection.select("0;8;0", "0;8;0");
        editor.selection.paragraphFormat.widowControl = false;
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(1);
        editor.editorHistory.undo();
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(2);
        editor.editorHistory.redo();
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(1);
    });
    it('Shifting case validation', () => {
       let sfdt: any ='{"sections":[{"blocks":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontColor":"empty"}},{"text":"European","characterFormat":{"fontColor":"empty"}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"styleName":"Normal"},"inlines":[]},{"characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12},"paragraphFormat":{"firstLineIndent":36,"afterSpacing":0,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"AdventureWorks","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"European","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" and Asian commercial markets. While its base operation ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"is located in","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" Bothell, Washington with 290 ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"employees, several regional sales teams are located throughout their ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"marke","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"sdweggqegqe","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"t","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" base","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":" ","characterFormat":{"fontSize":12,"fontColor":"empty","fontSizeBidi":12}},{"text":"the fictitious ","characterFormat":{"fontColor":"empty"}},{"text":"company on which","characterFormat":{"bold":true,"fontColor":"empty","boldBidi":true}},{"text":" the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"bold":true,"fontColor":"empty","boldBidi":true}},{"text":" sample","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"firstLineIndent":36,"styleName":"Normal"},"inlines":[{"text":"Adventure Works Cycles, the fictitious company on which the ","characterFormat":{"fontColor":"empty"}},{"text":"AdventureWorks","characterFormat":{"fontColor":"empty"}},{"text":" sample databases are based, is a large, multinational manufacturing company. The company manufactures and sells metal and composite bicycles to North American, European and Asian commercial markets. While its base operation ","characterFormat":{"fontColor":"empty"}},{"text":"is located in","characterFormat":{"fontColor":"empty"}},{"text":" Bothell, Washington with 290 employees, several regional sales teams are located throughout their market base.","characterFormat":{"fontColor":"empty"}}]},{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"styleName":"Normal"},"inlines":[]}],"headersFooters":{"header":{"blocks":[{"inlines":[]}]},"footer":{"blocks":[{"inlines":[]}]},"evenHeader":{"blocks":[{"inlines":[]}]},"evenFooter":{"blocks":[{"inlines":[]}]},"firstPageHeader":{"blocks":[{"inlines":[]}]},"firstPageFooter":{"blocks":[{"inlines":[]}]}},"sectionFormat":{"headerDistance":36,"footerDistance":36,"pageWidth":612,"pageHeight":792,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"restartPageNumbering":false,"pageStartingNumber":0,"endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart"}}],"characterFormat":{"fontSize":11,"fontFamily":"Calibri","fontColor":"empty","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"paragraphFormat":{"afterSpacing":8,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple"},"background":{"color":"#FFFFFFFF"},"styles":[{"type":"Paragraph","name":"Normal","next":"Normal","characterFormat":{"fontColor":"empty"}},{"type":"Character","name":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}},{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","link":"Header Char","characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","tabs":[{"tabJustification":"Center","position":234,"tabLeader":"None","deletePosition":0},{"tabJustification":"Right","position":468,"tabLeader":"None","deletePosition":0}]}},{"type":"Character","name":"Header Char","basedOn":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}},{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","link":"Footer Char","characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","tabs":[{"tabJustification":"Center","position":234,"tabLeader":"None","deletePosition":0},{"tabJustification":"Right","position":468,"tabLeader":"None","deletePosition":0}]}},{"type":"Character","name":"Footer Char","basedOn":"Default Paragraph Font","characterFormat":{"fontColor":"empty"}}],"defaultTabWidth":36,"formatting":false,"trackChanges":false,"protectionType":"NoProtection","enforcement":false,"dontUseHTMLParagraphAutoSpacing":false,"alignTablesRowByRow":false,"formFieldShading":true,"footnotes":{"separator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0003","characterFormat":{"fontColor":"empty"}}]}],"continuationSeparator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0004","characterFormat":{"fontColor":"empty"}}]}],"continuationNotice":[{"inlines":[]}]},"endnotes":{"separator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0003","characterFormat":{"fontColor":"empty"}}]}],"continuationSeparator":[{"characterFormat":{"fontColor":"empty"},"paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","styleName":"Normal"},"inlines":[{"text":"\\u0004","characterFormat":{"fontColor":"empty"}}]}],"continuationNotice":[{"inlines":[]}]},"compatibilityMode":3}';
        editor.open(sfdt);
        expect(editor.documentHelper.pages.length).toBe(2);
        editor.selection.select("0;8;0", "0;8;0");
        editor.editorModule.onEnter();
        expect((editor.documentHelper.pages[0].bodyWidgets[0].lastChild as ParagraphWidget).childWidgets.length).toBe(4);
        editor.editorModule.onEnter();
        expect((editor.documentHelper.pages[0].bodyWidgets[0].lastChild as ParagraphWidget).childWidgets.length).toBe(3);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(3);
        editor.editorModule.onEnter();
        expect((editor.documentHelper.pages[0].bodyWidgets[0].lastChild as ParagraphWidget).childWidgets.length).toBe(2);
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(4);
        editor.editorModule.onEnter();
        expect((editor.documentHelper.pages[1].bodyWidgets[0].firstChild as ParagraphWidget).childWidgets.length).toBe(6);
    });
});
