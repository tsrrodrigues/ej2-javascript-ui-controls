import { DocumentEditor } from '../../../src/document-editor/document-editor';
import { createElement } from '@syncfusion/ej2-base';
import { TestHelper } from '../../test-helper.spec';
import { BodyWidget, LineWidget, ListTextElementBox, ParagraphWidget, Selection} from '../../../src/index';
import { Editor } from '../../../src/index';
import { WListLevel } from '../../../src/document-editor/implementation/list/list-level';
import { EditorHistory } from '../../../src/document-editor/implementation/editor-history/editor-history';
import { SfdtExport } from "../../../src/document-editor/implementation/writer/sfdt-export";
describe('WListLevel Validation Testing', () => {
    it('List Level  Testing', () => {
console.log('List Level  Testing');
        let list: WListLevel = new WListLevel(undefined);
        list.followCharacter = 'Tab';
        list.listLevelPattern = 'Arabic';
        list.followCharacter;
        list.listLevelPattern;
        expect('').toBe('');
    });
});
describe('Check the multilevel numbering list format', () => {
    let container: DocumentEditor;
    beforeAll(() => {
        document.body.innerHTML = '';
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        DocumentEditor.Inject(Editor, Selection, EditorHistory, SfdtExport);
        container = new DocumentEditor({ enableEditor: true, isReadOnly: false, enableEditorHistory: true, enableSfdtExport: true });
        (container.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (container.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (container.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (container.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        container.appendTo('#container');
    });
    afterAll((done): void => {
        container.destroy();
        document.body.removeChild(document.getElementById('container'));
        container = undefined;
        document.body.innerHTML = '';
        setTimeout(function () {
            done();
        }, 1000);
    });
    it('Check the multilevel list format after modify the indent value', function () {
        console.log('Check the multilevel list format afetr modify the indent value');
        let text: any = {"sections":[{"sectionFormat":{"pageWidth":595.4500122070312,"pageHeight":841.7000122070312,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"differentFirstPage":false,"differentOddAndEvenPages":false,"headerDistance":36,"footerDistance":36,"bidi":false},"blocks":[{"paragraphFormat":{"textAlignment":"Left","styleName":"Normal","listFormat":{}},"characterFormat":{"bold":true,"fontSize":11,"fontFamily":"Arial","boldBidi":true,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[]},{"paragraphFormat":{"textAlignment":"Justify","styleName":"Normal","listFormat":{"listId":0,"listLevelNumber":0}},"characterFormat":{"bold":true,"fontSize":11,"fontFamily":"Arial","boldBidi":true,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[{"characterFormat":{"bold":true,"fontSize":11,"fontFamily":"Arial","boldBidi":true,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"YOUR "},{"characterFormat":{"bold":true,"fontSize":11,"fontFamily":"Arial","boldBidi":true,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"POSITION"}]},{"paragraphFormat":{"leftIndent":36,"firstLineIndent":0,"textAlignment":"Justify","styleName":"Normal","listFormat":{"listId":-1,"listLevelNumber":0}},"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[]},{"paragraphFormat":{"textAlignment":"Justify","styleName":"Normal","listFormat":{"listId":0,"listLevelNumber":1}},"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"You "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"will "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"be "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"employed "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"in "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"the "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"role "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"of "},{"characterFormat":{},"bookmarkType":0,"name":"DATA::298dd580_553b_4dcd_9cd0_b88549939ac1::details.jobTitle"},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"__________"},{"characterFormat":{},"bookmarkType":1,"name":"DATA::298dd580_553b_4dcd_9cd0_b88549939ac1::details.jobTitle"},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"."}]},{"paragraphFormat":{"leftIndent":36,"firstLineIndent":0,"textAlignment":"Justify","styleName":"Normal","listFormat":{"listId":-1,"listLevelNumber":0}},"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[]},{"paragraphFormat":{"textAlignment":"Justify","styleName":"Normal","listFormat":{"listId":0,"listLevelNumber":1}},"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"In "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"addition "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"to "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"any "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"duties "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"allocated "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"by "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"the "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"Employer "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"from "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"time "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"to "},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"time"},{"characterFormat":{"fontSize":11,"fontFamily":"Arial","bidi":false,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"text":"."}]},{"paragraphFormat":{"textAlignment":"Justify","styleName":"Normal","listFormat":{}},"characterFormat":{"bold":true,"fontSize":11,"fontFamily":"Arial","boldBidi":true,"fontSizeBidi":11,"fontFamilyBidi":"Arial"},"inlines":[]}],"headersFooters":{"footer":{"blocks":[{"paragraphFormat":{"textAlignment":"Center","styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{"fontSize":10,"fontFamily":"Arial","fontSizeBidi":10,"fontFamilyBidi":"Arial"},"fieldType":0,"hasFieldEnd":true},{"characterFormat":{"fontSize":10,"fontFamily":"Arial","fontSizeBidi":10,"fontFamilyBidi":"Arial"},"text":"PAGE  \\* MERGEFORMAT"},{"characterFormat":{},"fieldType":2},{"characterFormat":{"fontSize":10,"fontFamily":"Arial","fontSizeBidi":10,"fontFamilyBidi":"Arial"},"text":"1"},{"characterFormat":{},"fieldType":1}]}]}}}],"characterFormat":{"bold":false,"italic":false,"fontSize":12,"fontFamily":"Liberation Serif","underline":"None","strikethrough":"None","baselineAlignment":"Normal","highlightColor":"NoColor","fontColor":"#000000FF","boldBidi":false,"italicBidi":false,"fontSizeBidi":12,"fontFamilyBidi":"Liberation Serif","allCaps":false},"paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":0,"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{},"bidi":false,"keepLinesTogether":false,"keepWithNext":false,"widowControl":true},"defaultTabWidth":35.45000076293945,"trackChanges":false,"enforcement":false,"hashValue":"","saltValue":"","formatting":false,"protectionType":"NoProtection","dontUseHTMLParagraphAutoSpacing":false,"formFieldShading":true,"compatibilityMode":"Word2013","styles":[{"name":"Default Paragraph Font","type":"Character","characterFormat":{}},{"name":"Normal","type":"Paragraph","paragraphFormat":{"listFormat":{}},"characterFormat":{"fontSize":12,"fontFamily":"Liberation Serif","fontColor":"#00000000","fontSizeBidi":12,"fontFamilyBidi":"Liberation Serif"},"next":"Normal"},{"name":"Numbering Symbols","type":"Character","characterFormat":{},"basedOn":"Default Paragraph Font"},{"name":"Heading","type":"Paragraph","paragraphFormat":{"beforeSpacing":12,"afterSpacing":6,"listFormat":{}},"characterFormat":{"fontSize":14,"fontFamily":"Liberation Sans","fontSizeBidi":14,"fontFamilyBidi":"Liberation Sans"},"basedOn":"Normal","next":"Body Text"},{"name":"Body Text","type":"Paragraph","paragraphFormat":{"beforeSpacing":0,"afterSpacing":7,"lineSpacing":1.149999976158142,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Body Text"},{"name":"List","type":"Paragraph","paragraphFormat":{"listFormat":{}},"characterFormat":{},"basedOn":"Body Text","next":"List"},{"name":"Caption","type":"Paragraph","paragraphFormat":{"beforeSpacing":6,"afterSpacing":6,"listFormat":{}},"characterFormat":{"italic":true,"fontSize":12,"italicBidi":true,"fontSizeBidi":12},"basedOn":"Normal","next":"Caption"},{"name":"Index","type":"Paragraph","paragraphFormat":{"listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Index"},{"name":"Heading 1","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":12,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level1","listFormat":{}},"characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontSizeBidi":16,"fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 1 Char","next":"Normal"},{"name":"Heading 1 Char","type":"Character","characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontSizeBidi":16,"fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 2","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level2","listFormat":{}},"characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontSizeBidi":13,"fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 2 Char","next":"Normal"},{"name":"Heading 2 Char","type":"Character","characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontSizeBidi":13,"fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 3","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level3","listFormat":{}},"characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763FF","fontSizeBidi":12,"fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 3 Char","next":"Normal"},{"name":"Heading 3 Char","type":"Character","characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763FF","fontSizeBidi":12,"fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 4","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level4","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","italicBidi":true,"fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 4 Char","next":"Normal"},{"name":"Heading 4 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496FF","italicBidi":true,"fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 5","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level5","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 5 Char","next":"Normal"},{"name":"Heading 5 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496FF","fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 6","type":"Paragraph","paragraphFormat":{"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level6","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763FF","fontFamilyBidi":"Calibri Light"},"basedOn":"Normal","link":"Heading 6 Char","next":"Normal"},{"name":"Heading 6 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763FF","fontFamilyBidi":"Calibri Light"},"basedOn":"Default Paragraph Font"}],"lists":[{"abstractListId":0,"levelOverrides":[],"listId":0}],"abstractLists":[{"abstractListId":0,"levels":[{"characterFormat":{"bold":true,"boldBidi":true},"paragraphFormat":{"leftIndent":36,"firstLineIndent":-36,"listFormat":{},"tabs":[{"position":36,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%1.","restartLevel":0,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":36,"firstLineIndent":-36,"listFormat":{},"tabs":[{"position":36,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%1.%2","restartLevel":1,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":63.349998474121094,"firstLineIndent":-27.350000381469727,"listFormat":{},"tabs":[{"position":63.349998474121094,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"LowLetter","numberFormat":"(%3)","restartLevel":2,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":90,"firstLineIndent":-26.649999618530273,"listFormat":{},"tabs":[{"position":90,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"LowRoman","numberFormat":"(%4)","restartLevel":3,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":108,"firstLineIndent":-18,"listFormat":{},"tabs":[{"position":108,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%5.","restartLevel":4,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":126,"firstLineIndent":-18,"listFormat":{},"tabs":[{"position":126,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%6.","restartLevel":5,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":144,"firstLineIndent":-18,"listFormat":{},"tabs":[{"position":144,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%7.","restartLevel":6,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":162,"firstLineIndent":-18,"listFormat":{},"tabs":[{"position":162,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%8.","restartLevel":7,"startAt":1},{"characterFormat":{},"paragraphFormat":{"leftIndent":180,"firstLineIndent":-18,"listFormat":{},"tabs":[{"position":180,"deletePosition":0,"tabJustification":"List","tabLeader":"None"}]},"followCharacter":"Tab","listLevelPattern":"Arabic","numberFormat":"%9.","restartLevel":8,"startAt":1}]}],"comments":[],"revisions":[],"customXml":[],"footnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{},"text":"\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{},"text":"\u0004"}]}],"continuationNotice":[{"paragraphFormat":{"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}]},"endnotes":{"separator":[{"paragraphFormat":{"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{},"text":"\u0003"}]}],"continuationSeparator":[{"paragraphFormat":{"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{},"text":"\u0004"}]}]}}
        container.openBlank();
        container.open(text);
        container.selection.select('0;3;0','0;5;123');
        container.editor.applyNumbering(container.selection.getLevelFormatNumber(),'LowLetter');
        container.editor.decreaseIndent();
        let bodyWidget: BodyWidget = container.editor.documentHelper.pages[0].bodyWidgets[0] as BodyWidget;
        let paragraphWidget: ParagraphWidget = bodyWidget.childWidgets[3] as ParagraphWidget;
        let lineWidget: LineWidget = paragraphWidget.childWidgets[0] as LineWidget;
        let listTextElementBox: ListTextElementBox = lineWidget.children[0] as ListTextElementBox;
        expect(listTextElementBox.text).toBe('a.');
    });
});
