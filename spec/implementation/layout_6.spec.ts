import { DocumentEditor } from '../../src/document-editor/document-editor';
import { createElement } from '@syncfusion/ej2-base';
import { Editor, Selection, Layout, PageLayoutViewer, ParagraphWidget, LineWidget, TextElementBox, ListTextElementBox } from '../../src/index';
import { TestHelper } from '../test-helper.spec';

let RTL_List: any = { "sections": [{ "blocks": [{ "paragraphFormat": { "styleName": "Normal" }, "inlines": [{ "text": "List :" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 1 } }, "inlines": [{ "text": "Bidi-false" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 1 }, "bidi": true }, "inlines": [{ "text": "Bidi-true" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 1 } }, "inlines": [{ "text": "Bidi false" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 3 } }, "inlines": [{ "text": "One" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 3 }, "bidi": true }, "inlines": [{ "text": "Two" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 3 } }, "inlines": [{ "text": "Three" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 0 } }, "inlines": [{ "text": "One" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 0 }, "bidi": true }, "inlines": [{ "text": "Two" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 0 } }, "inlines": [{ "text": "سشسش", "characterFormat": { "bidi": true } }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 2 } }, "inlines": [{ "text": "Sample1" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 2 }, "bidi": true }, "inlines": [{ "text": "Sample" }] }, { "paragraphFormat": { "styleName": "List Paragraph", "listFormat": { "listLevelNumber": 0, "listId": 2 } }, "inlines": [{ "text": "Sample3" }] }, { "paragraphFormat": { "styleName": "Normal" }, "inlines": [] }, { "characterFormat": { "bidi": true }, "paragraphFormat": { "textAlignment": "Justify", "styleName": "Normal", "bidi": true }, "inlines": [{ "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג ", "characterFormat": { "bidi": true } }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }, { "text": " " }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }] }, { "characterFormat": { "bidi": true }, "paragraphFormat": { "textAlignment": "Center", "styleName": "Normal", "bidi": true }, "inlines": [{ "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג ", "characterFormat": { "bidi": true } }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }, { "text": " " }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }] }, { "characterFormat": { "bidi": true }, "paragraphFormat": { "textAlignment": "Justify", "styleName": "Normal", "bidi": true }, "inlines": [{ "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג ", "characterFormat": { "bidi": true } }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }, { "text": " " }, { "text": "Sample " }, { "text": "sample" }, { "text": " samples sample " }, { "text": "سشةحمث أثممخص صخقي ", "characterFormat": { "bidi": true } }, { "text": "דשצפךק יקךךם 'םרךג", "characterFormat": { "bidi": true } }] }, { "characterFormat": { "bidi": true }, "paragraphFormat": { "textAlignment": "Left", "styleName": "Normal", "bidi": true }, "inlines": [{ "name": "_GoBack", "bookmarkType": 0 }, { "name": "_GoBack", "bookmarkType": 1 }] }], "headersFooters": {}, "sectionFormat": { "headerDistance": 36.0, "footerDistance": 36.0, "pageWidth": 612.0, "pageHeight": 792.0, "leftMargin": 72.0, "rightMargin": 72.0, "topMargin": 72.0, "bottomMargin": 72.0, "differentFirstPage": false, "differentOddAndEvenPages": false, "bidi": false } }], "characterFormat": { "fontSize": 11.0, "fontFamily": "Calibri" }, "paragraphFormat": { "afterSpacing": 8.0, "lineSpacing": 1.0791666507720947, "lineSpacingType": "Multiple" }, "lists": [{ "listId": 0, "abstractListId": 0 }, { "listId": 1, "abstractListId": 1 }, { "listId": 2, "abstractListId": 2 }, { "listId": 3, "abstractListId": 3 }], "abstractLists": [{ "abstractListId": 0, "levels": [{ "startAt": 1, "restartLevel": 0, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%1.", "paragraphFormat": { "leftIndent": 36.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 1, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%2.", "paragraphFormat": { "leftIndent": 72.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 2, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%3.", "paragraphFormat": { "leftIndent": 108.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 3, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%4.", "paragraphFormat": { "leftIndent": 144.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 4, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%5.", "paragraphFormat": { "leftIndent": 180.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 5, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%6.", "paragraphFormat": { "leftIndent": 216.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 6, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%7.", "paragraphFormat": { "leftIndent": 252.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 7, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%8.", "paragraphFormat": { "leftIndent": 288.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 8, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%9.", "paragraphFormat": { "leftIndent": 324.0, "firstLineIndent": -9.0 } }] }, { "abstractListId": 1, "levels": [{ "startAt": 1, "restartLevel": 0, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%1.", "paragraphFormat": { "leftIndent": 36.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 1, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%2.", "paragraphFormat": { "leftIndent": 72.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 2, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%3.", "paragraphFormat": { "leftIndent": 108.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 3, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%4.", "paragraphFormat": { "leftIndent": 144.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 4, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%5.", "paragraphFormat": { "leftIndent": 180.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 5, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%6.", "paragraphFormat": { "leftIndent": 216.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 6, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%7.", "paragraphFormat": { "leftIndent": 252.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 7, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%8.", "paragraphFormat": { "leftIndent": 288.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 8, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%9.", "paragraphFormat": { "leftIndent": 324.0, "firstLineIndent": -9.0 } }] }, { "abstractListId": 2, "levels": [{ "startAt": 1, "restartLevel": 0, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%1)", "paragraphFormat": { "leftIndent": 36.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 1, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%2.", "paragraphFormat": { "leftIndent": 72.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 2, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%3.", "paragraphFormat": { "leftIndent": 108.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 3, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%4.", "paragraphFormat": { "leftIndent": 144.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 4, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%5.", "paragraphFormat": { "leftIndent": 180.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 5, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%6.", "paragraphFormat": { "leftIndent": 216.0, "firstLineIndent": -9.0 } }, { "startAt": 1, "restartLevel": 6, "listLevelPattern": "Arabic", "followCharacter": "Tab", "numberFormat": "%7.", "paragraphFormat": { "leftIndent": 252.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 7, "listLevelPattern": "LowLetter", "followCharacter": "Tab", "numberFormat": "%8.", "paragraphFormat": { "leftIndent": 288.0, "firstLineIndent": -18.0 } }, { "startAt": 1, "restartLevel": 8, "listLevelPattern": "LowRoman", "followCharacter": "Tab", "numberFormat": "%9.", "paragraphFormat": { "leftIndent": 324.0, "firstLineIndent": -9.0 } }] }, { "abstractListId": 3, "levels": [{ "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Symbol" }, "paragraphFormat": { "leftIndent": 36.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "o", "characterFormat": { "fontFamily": "Courier New" }, "paragraphFormat": { "leftIndent": 72.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Wingdings" }, "paragraphFormat": { "leftIndent": 108.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Symbol" }, "paragraphFormat": { "leftIndent": 144.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "o", "characterFormat": { "fontFamily": "Courier New" }, "paragraphFormat": { "leftIndent": 180.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Wingdings" }, "paragraphFormat": { "leftIndent": 216.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Symbol" }, "paragraphFormat": { "leftIndent": 252.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "o", "characterFormat": { "fontFamily": "Courier New" }, "paragraphFormat": { "leftIndent": 288.0, "firstLineIndent": -18.0 } }, { "listLevelPattern": "Bullet", "followCharacter": "Tab", "numberFormat": "", "characterFormat": { "fontFamily": "Wingdings" }, "paragraphFormat": { "leftIndent": 324.0, "firstLineIndent": -18.0 } }] }], "background": { "color": "#FFFFFFFF" }, "styles": [{ "type": "Paragraph", "name": "Normal", "next": "Normal" }, { "type": "Character", "name": "Default Paragraph Font" }, { "type": "Paragraph", "name": "List Paragraph", "basedOn": "Normal", "next": "List Paragraph", "paragraphFormat": { "leftIndent": 36.0 } }] };

describe('RTL List Paragraph layout validation', () => {
    let editor: DocumentEditor = undefined;
    beforeAll(() => {
        document.body.innerHTML = '';
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        editor = new DocumentEditor({});
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
        editor.open(JSON.stringify(RTL_List));
    });
    afterAll((done) => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        document.body.innerHTML = '';
        setTimeout(() => {
            done();
        }, 1000);
    });
    it('List numbering bidi true validation', () => {
console.log('List numbering bidi true validation');
        let paraWidget: ParagraphWidget = (editor.documentHelper.pages[0].bodyWidgets[0].childWidgets[2] as ParagraphWidget);
        let line: LineWidget = paraWidget.childWidgets[0] as LineWidget;
        expect(paraWidget.paragraphFormat.bidi).toBe(true);
        expect(line.children[2] instanceof ListTextElementBox).toBe(true);
    });
    it('Bullet list bidi true validation', () => {
console.log('Bullet list bidi true validation');
        let paraWidget: ParagraphWidget = (editor.documentHelper.pages[0].bodyWidgets[0].childWidgets[5] as ParagraphWidget);
        let line: LineWidget = paraWidget.childWidgets[0] as LineWidget;
        expect(paraWidget.paragraphFormat.textAlignment).toBe('Right');
        expect(line.children[2] instanceof ListTextElementBox).toBe(true);
    });
});
